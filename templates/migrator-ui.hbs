<div class="migrator-ui">
  <header class="form-header">
    <h3>L5R4 Migration Tool</h3>
    <p class="notes">
      <strong>System:</strong> {{systemId}} | <strong>World:</strong> {{worldName}}
    </p>
  </header>
  
  <section class="standard-form">
    <div class="notification info flexrow">
      {{#if isL5R4}}
        <span>Running on <strong>l5r4</strong> - Ready to export</span>
      {{else if isL5R4Enhanced}}
        <span>Running on <strong>l5r4-enhanced</strong> - Ready to import</span>
      {{else}}
        <span>Unsupported system: {{systemId}}</span>
      {{/if}}
    </div>
    
    {{#if hasExportData}}
    <div class="notification info flexrow">
      <span>Export data loaded</span>
    </div>
    {{/if}}
    
    {{#if hasValidation}}
    <div class="notification {{#if validationReady}}success{{else}}warning{{/if}} flexrow">
      {{#if validationReady}}
        <span>Validation passed - Ready to import!</span>
      {{else}}
        <span>Validation found issues - Check report</span>
      {{/if}}
    </div>
    {{/if}}
    
    {{#if schemaDetection}}
    <div class="notification info">
      <h4>Detected Schema</h4>
      <div class="form-fields">
        <div class="form-group">
          <label>Schema State:</label>
          <span class="tag state-{{schemaDetection.state}}">{{schemaDetection.stateLabel}}</span>
        </div>
        <div class="form-group">
          <label>Confidence:</label>
          <span class="tag confidence-{{schemaDetection.confidenceClass}}">{{schemaDetection.confidence}}%</span>
        </div>
        <div class="form-group">
          <label>Import Strategy:</label>
          <span>{{schemaDetection.strategyLabel}}</span>
        </div>
      </div>
    </div>
    {{/if}}
  </section>
  
  <section class="standard-form">
    <h3 class="form-header">Migration Workflow</h3>
    
    <!-- Step 1: Backup -->
    <div class="form-group">
      <label class="step-label">Create Backup (Recommended)</label>
      <div class="form-fields">
        <button type="button" data-action="backup">
          <i class="fas fa-save"></i>
          Create Backup
        </button>
      </div>
      <p class="hint">Create a safety backup before starting migration</p>
    </div>
    
    <!-- Step 2: Export (l5r4 only) -->
    {{#if isL5R4}}
    <div class="form-group">
      <label class="step-label">Export World Data</label>
      <div class="form-fields">
        <button type="button" data-action="export">
          <i class="fas fa-file-export"></i>
          Export Data
        </button>
      </div>
      <p class="hint">Export all actors, items, and world data from l5r4 system</p>
      <p class="hint">
        <em>After export, switch to l5r4-enhanced system and upload the export file</em>
      </p>
    </div>
    {{/if}}
    
    <!-- Step 2: Upload (l5r4-enhanced only) -->
    {{#if isL5R4Enhanced}}
    <div class="form-group">
      <label class="step-label">Upload Export File</label>
      <div class="form-fields">
        <button type="button" data-action="uploadFile">
          <i class="fas fa-upload"></i>
          Upload Export File
        </button>
      </div>
      {{#if hasExportData}}
      <p class="hint">Load the export file from your l5r4 world</p>
      <p class="hint success">
        <i class="fas fa-check"></i> <em>Export data loaded</em>
      </p>
      {{/if}}
    </div>
    
    <!-- Step 3: Validate -->
    <div class="form-group">
      <label class="step-label">Validate Data</label>
      <div class="form-fields">
        <button type="button" data-action="validate" {{#unless hasExportData}}disabled{{/unless}}>
          <i class="fas fa-check-double"></i>
          Validate Data
        </button>
      </div>
      <p class="hint">Check data integrity and migration readiness</p>
      {{#if hasValidation}}
      <p class="hint {{#if validationReady}}success{{else}}warning{{/if}}">
        <i class="fas {{#if validationReady}}fa-check{{else}}fa-exclamation{{/if}}"></i>
        <em>Validation {{#if validationReady}}passed{{else}}found issues{{/if}}</em>
      </p>
      {{/if}}
    </div>
    
    <!-- Step 4: Import -->
    <div class="form-group">
      <label class="step-label">Import to l5r4-enhanced</label>
      <div class="form-fields">
        <button type="button" data-action="import" class="important" {{#unless hasExportData}}disabled{{/unless}}>
          <i class="fas fa-file-import"></i>
          Import Data
        </button>
      </div>
      <p class="hint">Transform and import data into current world</p>
      <p class="hint warning">
        <i class="fas fa-exclamation-triangle"></i>
        <em>Create a backup first! Import will add documents to this world.</em>
      </p>
    </div>
    {{/if}}
  </section>
</div>
